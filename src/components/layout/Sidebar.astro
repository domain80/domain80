---
import ThemeToggle from "../ui/ThemeToggle.astro";
import Button from "../ui/Button.astro";
import { Icon } from 'astro-icon/components';
---

<div class="space-y-6">
  <!-- Theme Toggle -->
  <ThemeToggle />

  <!-- Name and Title -->
  <div class="space-y-2 mt-6">
    <h1 class="text-5xl font-bold text-gray-900 dark:text-gray-100">
      David Mainoo
    </h1>
    <p class="text-gray-600 dark:text-gray-400 font-medium">
      Software Engineer
    </p>
  </div>

  <!-- Bio -->
  <p class="text-gray-700 dark:text-gray-300 leading-relaxed">
    It is no surprise that the AI age has mode us rediscover and realign with
    why we do what we do as software engineers giving us an opportunity to grow
    and evolve. Hi there and what a time to be alive.
  </p>

  <!-- CTA Buttons -->
  <div class="flex flex-wrap gap-3">
    <Button href="#" variant="outline">
      <Icon name="tabler:message-circle" class="w-4 h-4" />
      Let's talk
    </Button>
    <a
      href="/rss.xml"
      class="inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-amber-600 dark:text-amber-500 hover:text-amber-700 dark:hover:text-amber-400 transition-colors rounded-lg"
    >
      <Icon name="tabler:rss" class="w-4 h-4" />
      Subscribe via RSS
    </a>
  </div>

  <!-- Navigation -->
  <nav class="space-y-4 pt-6 border-t border-gray-200 dark:border-gray-800">
    <a
      href="#whats-on-my-mind"
      data-nav-link="whats-on-my-mind"
      class="nav-link flex items-center gap-2 text-gray-700 dark:text-gray-300 hover:text-accent dark:hover:text-accent transition-colors"
    >
      <Icon name="tabler:clipboard-list" class="w-5 h-5" />
      What's on my mind?
    </a>
    <a
      href="#projects"
      data-nav-link="projects"
      class="nav-link flex items-center gap-2 text-gray-700 dark:text-gray-300 hover:text-accent dark:hover:text-accent transition-colors"
    >
      <Icon name="tabler:stack-2" class="w-5 h-5" />
      Projects
    </a>
  </nav>

  <script>
    function initSidebarNav() {
      // Intersection Observer for active nav highlighting
      const observerOptions = {
        root: null,
        rootMargin: "-20% 0px -60% 0px",
        threshold: 0,
      };

      const observer = new IntersectionObserver((entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            // Remove active class from all nav links
            document.querySelectorAll(".nav-link").forEach((link) => {
              link.classList.remove("text-accent", "font-semibold");
              link.classList.add("text-gray-700", "dark:text-gray-300");
            });

            // Add active class to current nav link
            const sectionId = entry.target.id;
            const activeLink = document.querySelector(
              `[data-nav-link="${sectionId}"]`
            );
            if (activeLink) {
              activeLink.classList.add("text-accent", "font-semibold");
              activeLink.classList.remove("text-gray-700", "dark:text-gray-300");
            }
          }
        });
      }, observerOptions);

      // Observe all sections
      const sections = document.querySelectorAll("#whats-on-my-mind, #projects");
      sections.forEach((section) => observer.observe(section));

      // Smooth scroll on click
      document.querySelectorAll(".nav-link").forEach((link) => {
        link.addEventListener("click", (e) => {
          e.preventDefault();
          const targetId = link.getAttribute("href")?.substring(1);
          const target = document.getElementById(targetId || "");
          target?.scrollIntoView({ behavior: "smooth", block: "start" });
        });
      });
    }

    // Initialize on page load
    initSidebarNav();

    // Re-initialize after page transitions
    document.addEventListener("astro:after-swap", initSidebarNav);
  </script>

  <!-- Social Links and Resume -->
  <div class="pt-6 border-t border-gray-200 dark:border-gray-800 space-y-4">
    <div class="flex items-center gap-4">
      <a
        href="https://github.com/yourusername"
        target="_blank"
        rel="noopener noreferrer"
        class="text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white transition-colors"
        aria-label="GitHub"
      >
        <Icon name="tabler:brand-github" class="w-6 h-6" />
      </a>
      <a
        href="https://linkedin.com/in/yourusername"
        target="_blank"
        rel="noopener noreferrer"
        class="text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white transition-colors"
        aria-label="LinkedIn"
      >
        <Icon name="tabler:brand-linkedin" class="w-6 h-6" />
      </a>
    </div>

    <a
      href="/resume.pdf"
      class="inline-flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400 hover:text-accent dark:hover:text-accent transition-colors"
    >
      My resume →
    </a>
  </div>

  <!-- Copyright -->
  <p
    class="text-xs text-gray-500 dark:text-gray-500 pt-6 border-t border-gray-200 dark:border-gray-800"
  >
    © Copyright 2025, David Mainoo.
  </p>
</div>
