---
// Theme toggle switch component with proper boolean checkbox
---

<div class="flex items-center gap-3">
  <label class="relative inline-flex items-center cursor-pointer">
    <input
      type="checkbox"
      id="theme-toggle"
      class="sr-only peer"
      aria-label="Toggle dark mode"
    />
    <div
      class="w-11 h-6 bg-zinc-300 dark:bg-zinc-600 rounded-full peer peer-focus:ring-2 peer-focus:ring-accent peer-focus:ring-offset-2 after:content-[''] after:absolute after:top-0.5 after:start-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-accent peer-checked:after:translate-x-full peer-checked:after:border-white"
    >
    </div>
  </label>
  <span id="theme-label" class="text-sm text-zinc-600 dark:text-zinc-400">
    Light Mode
  </span>
</div>

<script is:inline>
  (function () {
    function initThemeToggle() {
      const toggle = document.getElementById("theme-toggle");
      const label = document.getElementById("theme-label");

      if (!toggle || !label) {
        console.error("Theme toggle elements not found");
        return;
      }

      function updateUI() {
        const isDark = document.documentElement.classList.contains("dark");
        toggle.checked = isDark;
        label.textContent = isDark ? "Dark Mode" : "Light Mode";
      }

      toggle.addEventListener("change", function () {
        if (toggle.checked) {
          document.documentElement.classList.add("dark");
          localStorage.setItem("theme", "dark");
        } else {
          document.documentElement.classList.remove("dark");
          localStorage.setItem("theme", "light");
        }

        updateUI();
      });

      // Initialize on page load
      updateUI();
    }

    // Run when DOM is ready
    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", initThemeToggle);
    } else {
      initThemeToggle();
    }

    // Re-initialize after page transitions
    document.addEventListener("astro:after-swap", initThemeToggle);
  })();
</script>
