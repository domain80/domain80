---
// Theme toggle component using DaisyUI toggle
---

<div class="flex items-center gap-3">
  <input
    type="checkbox"
    id="theme-toggle"
    class="toggle toggle-accent"
    aria-label="Toggle dark mode"
  />
  <span id="theme-label" class="text-sm text-gray-600 dark:text-gray-400">
    Light Mode
  </span>
</div>

<script is:inline>
  (function () {
    function initThemeToggle() {
      const toggle = document.getElementById("theme-toggle");
      const label = document.getElementById("theme-label");

      if (!toggle || !label) {
        console.error("Theme toggle elements not found");
        return;
      }

      function updateUI() {
        const isDark = document.documentElement.classList.contains("dark");
        toggle.checked = isDark;
        label.textContent = isDark ? "Dark Mode" : "Light Mode";
      }

      toggle.addEventListener("change", function () {
        if (toggle.checked) {
          document.documentElement.classList.add("dark");
          localStorage.setItem("theme", "dark");
        } else {
          document.documentElement.classList.remove("dark");
          localStorage.setItem("theme", "light");
        }

        updateUI();
      });

      // Initialize on page load
      updateUI();
    }

    // Run when DOM is ready
    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", initThemeToggle);
    } else {
      initThemeToggle();
    }

    // Re-initialize after page transitions
    document.addEventListener("astro:after-swap", initThemeToggle);
  })();
</script>
